(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/tabbar/tabbar-1/editActive/limitedMode/likeCollect/likeCollect"],{"0a15":function(t,e,i){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=s(i("6041")),o=s(i("eb14")),n=s(i("9403"));function s(t){return t&&t.__esModule?t:{default:t}}var c={data:function(){var t=this.getDate({format:!0});return{activeName:"",ads:[],readyToUpdate:!0,coupon:{couponName:"请输入券名",availableTime:t,exTime:"",organization:"请选择机构",rule:"",disable:!0,modifyDiscount:!1,toplimit:"",company_index:0},couponList:[],activityId:0}},components:{xyDialog:a.default},onLoad:function(){},created:function(){var t=this;t.coupon.organization=n.default.getcompany().company_name},computed:{startDate:function(){return this.getDate("start")},endDate:function(){return this.getDate("end")}},methods:{bindDateChange:function(t){var e=this;console.log(t);var i=t.target.value;if(0==t.currentTarget.id)e.coupon.availableTime=i;else{var a=t.currentTarget.id-1;e.couponList[a].availableTime=i}},getDate:function(t){var e=new Date,i=e.getFullYear(),a=e.getMonth()+1,o=e.getDate();return"start"===t?i-=60:"end"===t&&(i+=2),a=a>9?a:"0"+a,o=o>9?o:"0"+o,"".concat(i,"-").concat(a,"-").concat(o)},jump:function(e){console.log(e),0==e.currentTarget.id?t.navigateTo({url:""}):(e.currentTarget.id,t.navigateTo({url:""}))},add_discount:function(){this.coupon.modifyDiscount=!0},add_img:function(){var e=this;t.chooseImage({success:function(t){var i=t.tempFilePaths,a={img:i[0]};e.ads.push(a)}}),this.activeName.length>0&&this.ads.length>0&&this.couponList.length>0?this.readyToUpdate=!1:this.readyToUpdate=!0},setTitle:function(t){this.activeName=t.detail.value,console.log(this.activeName),this.activeName.length>0&&this.couponList.length>0?this.readyToUpdate=!1:this.readyToUpdate=!0},setLink:function(t){this.ads[t.currentTarget.id].link=t.detail.value,this.activeName.length>0&&this.ads.length>0&&this.couponList.length>0?this.readyToUpdate=!1:this.readyToUpdate=!0},setName:function(t){if(console.log(t),0==t.currentTarget.id)this.coupon.couponName=t.detail.value,this.coupon.couponName.length>0&&this.coupon.toplimit.length>0&&"请输入券名"!=this.coupon.couponName&&this.coupon.exTime.length>0&&this.coupon.rule.length>0?this.coupon.disable=!1:this.coupon.disable=!0;else{var e=t.currentTarget.id-1;console.log(e),this.couponList[e].couponName=t.detail.value,this.couponList[e].couponName.length>0&&"请输入券名"!=this.couponList[e].couponName&&this.couponList[e].toplimit.length>0&&this.couponList[e].exTime.length>0&&this.couponList[e].rule.length>0?this.couponList[e].disable=!1:this.couponList[e].disable=!0}},setToplimit:function(t){if(console.log(t),0==t.currentTarget.id)this.coupon.toplimit=t.detail.value,this.coupon.couponName.length>0&&"请输入券名"!=this.coupon.couponName&&this.coupon.toplimit.length>0&&this.coupon.exTime.length>0&&this.coupon.rule.length>0?this.coupon.disable=!1:this.coupon.disable=!0;else{var e=t.currentTarget.id-1;console.log(e),this.couponList[e].toplimit=t.detail.value,this.couponList[e].couponName.length>0&&"请输入券名"!=this.couponList[e].couponName&&this.couponList[e].toplimit.length>0&&this.couponList[e].exTime.length>0&&this.couponList[e].rule.length>0?this.couponList[e].disable=!1:this.couponList[e].disable=!0}},setATime:function(t){if(0==t.currentTarget.id)this.coupon.availableTime=t.detail.value,this.coupon.couponName.length>0&&"请输入券名"!=this.coupon.couponName&&this.coupon.toplimit.length>0&&this.coupon.exTime.length>0&&this.coupon.rule.length>0?this.coupon.disable=!1:this.coupon.disable=!0;else{var e=t.currentTarget.id-1;this.couponList[e].availableTime=t.detail.value,this.couponList[e].couponName.length>0&&"请输入券名"!=this.couponList[e].couponName&&this.couponList[e].toplimit.length>0&&this.couponList[e].exTime.length>0&&this.couponList[e].rule.length>0?this.couponList[e].disable=!1:this.couponList[e].disable=!0}},setETime:function(t){if(0==t.currentTarget.id)this.coupon.exTime=t.detail.value,this.coupon.couponName.length>0&&"请输入券名"!=this.coupon.couponName&&this.coupon.toplimit.length>0&&this.coupon.exTime.length>0&&this.coupon.rule.length>0?this.coupon.disable=!1:this.coupon.disable=!0;else{var e=t.currentTarget.id-1;this.couponList[e].exTime=t.detail.value,this.couponList[e].couponName.length>0&&"请输入券名"!=this.couponList[e].couponName&&this.couponList[e].toplimit.length>0&&this.couponList[e].exTime.length>0&&this.couponList[e].rule.length>0?this.couponList[e].disable=!1:this.couponList[e].disable=!0}},setRule:function(t){if(0==t.currentTarget.id)this.coupon.rule=t.detail.value,this.coupon.couponName.length>0&&"请输入券名"!=this.coupon.couponName&&this.coupon.toplimit.length>0&&this.coupon.exTime.length>0&&this.coupon.rule.length>0?this.coupon.disable=!1:this.coupon.disable=!0;else{var e=t.currentTarget.id-1;this.couponList[e].rule=t.detail.value,this.couponList[e].couponName.length>0&&"请输入券名"!=this.couponList[e].couponName&&this.couponList[e].toplimit.length>0&&this.couponList[e].exTime.length>0&&this.couponList[e].rule.length>0?this.couponList[e].disable=!1:this.couponList[e].disable=!0}},toDetail:function(e){0==e?t.navigateTo({url:"coupon?detail="+JSON.stringify(this.coupon)+"&ads="+JSON.stringify(this.ads)}):(e--,console.log(e),t.navigateTo({url:"coupon?detail="+JSON.stringify(this.couponList[e])+"&ads="+JSON.stringify(this.ads)}))},addCoupon:function(){if(0==this.coupon.disable){this.coupon.modifyDiscount=!1,this.couponList.push(this.coupon);var e=this.getDate({format:!0});this.coupon={couponName:"请输入券名",availableTime:e,exTime:"",organization:n.default.getcompany().company_name,rule:"",disable:!0,modifyDiscount:!1,toplimit:""}}else t.showToast({title:"请填写完整信息",icon:"none"});this.activeName.length>0&&this.couponList.length>0?this.readyToUpdate=!1:this.readyToUpdate=!0},modify:function(t){this.couponList[t].modifyDiscount=!0},save:function(t){this.couponList[t].modifyDiscount=!1},createActive:function(){this.$refs.xyDialog02.alert()},saveActive:function(){var e=this,i={activeName:e.activeName,activityId:e.activityId,ads:e.ads,couponList:e.couponList};t.setStorage({key:"active",data:i,success:function(){console.log("success"),t.showToast({title:"保存成功"}),setTimeout(function(){t.navigateBack({delta:1})},2e3)}})},handleClose:function(){console.log("点击关闭按钮"),t.showToast({title:"点击关闭按钮,触发自定义事件",icon:"none"})},handleConfirm:function(){var e=this;console.log("点击确定按钮"),t.request({url:o.default.companyActivity(),method:"POST",header:{"content-type":"application/x-www-form-urlencoded",token:n.default.getToken()},data:{name:e.activeName,companyId:n.default.getcompany().company_id},success:function(i){if(console.log(i),200==i.data.code){e.activityId=i.data.value.activity_id;var a=new Date(e.coupon.availableTime).getTime()/1e3;"NaN"==a.toString()&&(a=0,console.log(a)),t.request({url:o.default.company(),method:"POST",header:{"content-type":"application/x-www-form-urlencoded",token:n.default.getToken()},data:{companyId:n.default.getcompany().company_id,activityId:e.activityId,name:e.coupon.couponName,state:e.coupon.rule,conditionContent:"1",vaildDays:e.coupon.exTime,num:e.coupon.toplimit,money:1,start:a},success:function(i){if(console.log(i),200==i.data.code){t.showToast({title:"活动创建成功",icon:"none"});var a=e.getDate({format:!0});e.coupon={couponName:"请输入券名",availableTime:a,exTime:"",organization:n.default.getcompany().company_name,rule:"",disable:!0,modifyDiscount:!1,toplimit:""},e.activeName="",e.ads=[],e.activityId=0}else t.showToast({title:"第"+x+"个您没有权限进行创建!",icon:"none"})}})}else t.showToast({title:"获取活动id失败",icon:"none"})}})}}};e.default=c}).call(this,i("543d")["default"])},"0a59":function(t,e,i){"use strict";i("901f");var a=n(i("b0ce")),o=n(i("2bbd"));function n(t){return t&&t.__esModule?t:{default:t}}Page((0,a.default)(o.default))},"2bbd":function(t,e,i){"use strict";i.r(e);var a=i("c73e"),o=i("3f22");for(var n in o)"default"!==n&&function(t){i.d(e,t,function(){return o[t]})}(n);i("c1db");var s=i("2877"),c=Object(s["a"])(o["default"],a["a"],a["b"],!1,null,null,null);e["default"]=c.exports},"3f22":function(t,e,i){"use strict";i.r(e);var a=i("0a15"),o=i.n(a);for(var n in a)"default"!==n&&function(t){i.d(e,t,function(){return a[t]})}(n);e["default"]=o.a},"40b2":function(t,e,i){},c1db:function(t,e,i){"use strict";var a=i("40b2"),o=i.n(a);o.a},c73e:function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("view",{staticClass:"body"},[i("view",{staticClass:"title"},[t._v("活动名称")]),i("view",{staticClass:"activeName"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.activeName,expression:"activeName"}],staticStyle:{width:"90%",margin:"auto"},attrs:{type:"text",value:t.activeName,placeholder:"请输入活动名称",eventid:"740cfb25-0"},domProps:{value:t.activeName},on:{input:[function(e){e.target.composing||(t.activeName=e.target.value)},t.setTitle]}})]),i("view",{staticClass:"title"},[t._v("活动内容")]),t._m(0),0==t.ads.length?i("view",{staticClass:"add_img"},[i("view",{staticStyle:{margin:"auto","margin-left":"50rpx"}},[t._v("添加广告图片")]),i("image",{attrs:{src:"../../../../../../static/img/addImg.png",eventid:"740cfb25-1"},on:{click:t.add_img}}),i("view",{staticStyle:{margin:"auto","margin-left":"50rpx","margin-top":"0"}},[t._v("输入广告链接")]),i("textarea",{staticStyle:{width:"85%",margin:"auto","margin-left":"70rpx","margin-top":"0",color:"#007AFF",height:"100rpx"},attrs:{type:"text",value:"",placeholder:"请输入广告推文链接"}})]):i("view",[t._l(t.ads,function(e,a){return i("view",{key:e.index,staticClass:"add_img"},[i("view",{staticStyle:{margin:"auto","margin-left":"50rpx"}},[t._v("图片"+t._s(a+1))]),i("image",{staticStyle:{width:"85%"},attrs:{src:e.img,eventid:"740cfb25-2-"+a},on:{click:t.add_img}}),i("view",{staticStyle:{margin:"auto","margin-left":"50rpx","margin-top":"0"}},[t._v("广告链接"+t._s(a+1))]),i("textarea",{staticStyle:{width:"85%",margin:"auto","margin-left":"70rpx","margin-top":"0",color:"#007AFF",height:"100rpx"},attrs:{type:"text",value:e.link,placeholder:"请输入广告推文链接",id:a,eventid:"740cfb25-3-"+a},on:{input:t.setLink}})])}),i("view",{staticClass:"add_reward",staticStyle:{"margin-top":"40rpx"}},[i("image",{attrs:{src:"../../../../../../static/img/addReward.png",eventid:"740cfb25-4"},on:{click:t.add_img}}),i("text",[t._v("继续添加广告图片")])])],2),i("view",{staticClass:"title",staticStyle:{"margin-top":"50rpx"}},[t._v("奖励设置")]),t.couponList.length>0?i("view",{},t._l(t.couponList,function(e,a){return i("view",{key:a},[i("view",{staticStyle:{width:"90%",display:"flex","justify-content":"space-between",margin:"auto","align-items":"center",height:"100rpx"}},[i("text",[t._v(t._s(a+1)+"等奖")]),i("button",{staticStyle:{margin:"0"},attrs:{type:"default",size:"mini",eventid:"740cfb25-5-"+a},on:{click:function(e){t.modify(a)}}},[t._v("修改")])],1),1==e.modifyDiscount?i("view",[i("view",{staticClass:"add_reward2"},[i("view",{staticClass:"couponImg"},[i("view",{staticClass:"left"},[i("text",{staticStyle:{margin:"auto"}},[t._v(t._s(e.organization))]),i("text",{staticStyle:{"font-size":"x-large",margin:"auto","margin-top":"0"}},[t._v(t._s(e.couponName))])]),i("view",{staticClass:"right"},[1==e.disable?i("button",{staticStyle:{background:"#BBBBBB"},attrs:{size:"mini"}},[t._v("查看详情")]):i("button",{attrs:{size:"mini",eventid:"740cfb25-6-"+a},on:{click:function(i){t.toDetail(e+1)}}},[t._v("查看详情")])],1)]),i("text",{staticStyle:{"padding-top":"20rpx",color:"#BBBBBB"}},[t._v("券预览图")]),i("view",{staticStyle:{width:"90%","padding-top":"20rpx"}},[t._v("填写相关信息")]),i("view",{staticClass:"inputs"},[i("text",{staticStyle:{width:"20%"}},[t._v("券名：")]),i("input",{staticStyle:{width:"85%","border-bottom":"1px solid #F2F2F2"},attrs:{type:"text",value:e.couponName,placeholder:"请输入券名",id:a+1,eventid:"740cfb25-7-"+a},on:{input:t.setName}})]),i("view",{staticClass:"inputs"},[i("view",{staticStyle:{width:"30%"}},[t._v("数量上限：")]),i("input",{staticStyle:{width:"70%","border-bottom":"1px solid #F2F2F2"},attrs:{type:"text",value:e.toplimit,placeholder:"请输入该券数量上限 (例: 300张)",id:a+1,eventid:"740cfb25-8-"+a},on:{input:t.setToplimit}})]),i("view",{staticClass:"inputs"},[i("view",{staticStyle:{width:"30%"}},[t._v("开始时间：")]),i("picker",{attrs:{mode:"date",id:a+1,value:e.availableTime,start:t.startDate,end:t.endDate,eventid:"740cfb25-9-"+a},on:{change:t.bindDateChange}},[i("view",{staticClass:"uni-input"},[t._v(t._s(e.availableTime))])])],1),i("view",{staticClass:"inputs"},[i("view",{staticStyle:{width:"30%"}},[t._v("券有效期：")]),i("input",{staticStyle:{width:"70%","border-bottom":"1px solid #F2F2F2"},attrs:{type:"text",value:e.exTime,placeholder:"请输入优惠券有效天数",id:a+1,eventid:"740cfb25-10-"+a},on:{input:t.setETime}})]),i("view",{staticClass:"inputs"},[i("view",{staticStyle:{width:"30%"}},[t._v("发券机构：")]),i("view",{staticClass:"uni-input"},[t._v(t._s(e.organization))])]),i("view",{staticClass:"inputs",staticStyle:{"align-items":"flex-start"}},[i("view",{staticStyle:{width:"30%"}},[t._v("使用规则：")]),i("textarea",{directives:[{name:"model",rawName:"v-model",value:e.rule,expression:"item.rule"}],staticStyle:{width:"70%","border-bottom":"1px solid #F2F2F2"},attrs:{type:"text","auto-height":"true",placeholder:"请输入使用规则",id:a+1,eventid:"740cfb25-11-"+a},domProps:{value:e.rule},on:{input:[function(t){t.target.composing||(e.rule=t.target.value)},t.setRule]}},[t._v('<s:property :value="item.rule"/>')])]),i("button",{staticClass:"btn",attrs:{eventid:"740cfb25-12-"+a},on:{click:function(e){t.save(a)}}},[t._v("确定")])],1)]):i("view",[i("view",{staticClass:"add_reward"},[i("view",{staticClass:"couponImg"},[i("view",{staticClass:"left"},[i("text",{staticStyle:{margin:"auto"}},[t._v(t._s(e.organization))]),i("text",{staticStyle:{"font-size":"x-large",margin:"auto","margin-top":"0"}},[t._v(t._s(e.couponName))])]),i("view",{staticClass:"right"},[1==e.disable?i("button",{staticStyle:{background:"#BBBBBB"},attrs:{size:"mini"}},[t._v("查看详情")]):i("button",{attrs:{size:"mini",eventid:"740cfb25-13-"+a},on:{click:function(e){t.toDetail(a+1)}}},[t._v("查看详情")])],1)])])])])})):t._e(),t._m(1),0==t.coupon.modifyDiscount?i("view",{staticClass:"add_reward",attrs:{eventid:"740cfb25-21"},on:{click:t.add_discount}},[i("image",{attrs:{src:"../../../../../../static/img/addReward.png"}}),i("text",[t._v("添加奖励")])]):i("view",{staticClass:"add_reward2"},[i("view",{staticClass:"couponImg"},[i("view",{staticClass:"left"},[i("text",{staticStyle:{margin:"auto"}},[t._v(t._s(t.coupon.organization))]),i("text",{staticStyle:{"font-size":"x-large",margin:"auto","margin-top":"0"}},[t._v(t._s(t.coupon.couponName))])]),i("view",{staticClass:"right"},[1==t.coupon.disable?i("button",{staticStyle:{background:"#BBBBBB"},attrs:{size:"mini"}},[t._v("查看详情")]):i("button",{attrs:{size:"mini",eventid:"740cfb25-14"},on:{click:function(e){t.toDetail(0)}}},[t._v("查看详情")])],1)]),i("text",{staticStyle:{"padding-top":"20rpx",color:"#BBBBBB"}},[t._v("券预览图")]),i("view",{staticStyle:{width:"90%","padding-top":"20rpx"}},[t._v("填写相关信息")]),i("view",{staticClass:"inputs"},[i("text",{staticStyle:{width:"20%"}},[t._v("券名：")]),i("input",{staticStyle:{width:"85%","border-bottom":"1px solid #F2F2F2"},attrs:{type:"text",value:"",placeholder:"请输入券名",id:"0",eventid:"740cfb25-15"},on:{input:t.setName}})]),i("view",{staticClass:"inputs"},[i("view",{staticStyle:{width:"30%"}},[t._v("数量上限：")]),i("input",{staticStyle:{width:"70%","border-bottom":"1px solid #F2F2F2"},attrs:{type:"text",placeholder:"请输入该券数量上限 (例: 300张)",id:"0",eventid:"740cfb25-16"},on:{input:t.setToplimit}})]),i("view",{staticClass:"inputs"},[i("view",{staticStyle:{width:"30%"}},[t._v("开始时间：")]),i("picker",{attrs:{mode:"date",value:t.coupon.availableTime,start:t.startDate,end:t.endDate,id:"0",eventid:"740cfb25-17"},on:{change:t.bindDateChange}},[i("view",{staticClass:"uni-input"},[t._v(t._s(t.coupon.availableTime))])])],1),i("view",{staticClass:"inputs"},[i("view",{staticStyle:{width:"30%"}},[t._v("券有效期：")]),i("input",{staticStyle:{width:"70%","border-bottom":"1px solid #F2F2F2"},attrs:{type:"text",value:"",placeholder:"请输入优惠券有效天数",id:"0",eventid:"740cfb25-18"},on:{input:t.setETime}})]),i("view",{staticClass:"inputs"},[i("view",{staticStyle:{width:"30%"}},[t._v("发券机构：")]),i("view",{}),i("view",{staticClass:"uni-input"},[t._v(t._s(t.coupon.organization))])]),i("view",{staticClass:"inputs",staticStyle:{"align-items":"flex-start"}},[i("view",{staticStyle:{width:"30%"}},[t._v("使用规则：")]),i("textarea",{directives:[{name:"model",rawName:"v-model",value:t.coupon.rule,expression:"coupon.rule"}],staticStyle:{width:"70%","border-bottom":"1px solid #F2F2F2"},attrs:{type:"text",value:"","auto-height":"true",placeholder:"请输入使用规则",id:"0",eventid:"740cfb25-19"},domProps:{value:t.coupon.rule},on:{input:[function(e){e.target.composing||(t.coupon.rule=e.target.value)},t.setRule]}})]),i("button",{staticClass:"btn",attrs:{eventid:"740cfb25-20"},on:{click:function(e){t.handleConfirm()}}},[t._v("创建")])],1),t.couponList.length>0?i("view",{staticStyle:{width:"80%",display:"flex","justify-content":"space-between",margin:"auto","margin-top":"100rpx"}},[i("button",{staticClass:"btnSave",attrs:{size:"default",eventid:"740cfb25-22"},on:{click:t.saveActive}},[t._v("保存")]),i("button",{staticClass:"btnCreate",attrs:{size:"default",disabled:t.readyToUpdate,eventid:"740cfb25-23"},on:{click:t.createActive}},[t._v("创建活动")])],1):t._e(),i("xy-dialog",{ref:"xyDialog02",attrs:{title:"false",message:"确定创建？",eventid:"740cfb25-24",mpcomid:"740cfb25-0"},on:{cancelButton:t.handleClose,confirmButton:t.handleConfirm}}),i("view",{staticClass:"title"})],1)},o=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("view",{staticClass:"preview"},[i("view",{staticClass:"preview_img"}),i("view",{staticClass:"preview_text"},[t._v("预览图")])])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("view",{staticStyle:{width:"90%",display:"flex","justify-content":"space-between",margin:"auto","align-items":"center",height:"100rpx"}},[i("text",[t._v("积攒奖励")])])}];i.d(e,"a",function(){return a}),i.d(e,"b",function(){return o})}},[["0a59","common/runtime","common/vendor"]]]);